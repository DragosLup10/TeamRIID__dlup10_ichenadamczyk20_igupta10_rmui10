<!--
The homepage for a logged-in user -- lists all blogs on the website

IMPORTS
/static/styles.css
/static/home.css
header.html

REQUIRES
blogs (list of dictionaries)
 -- blogs[i]["id"]          - ID of blog
 -- blogs[i]["name"]        - Name
 -- blogs[i]["username"]    - Username
 -- blogs[i]["description"] - Description of blog
 -- blogs[i]["datetime"]    - Datetime of latest entry (in human readable format)
 -- blogs[i]["following"]   - Whether the user is following this blog
username - (String username of user)

[if user wants to edit blog]
SENDS to /my-blog by GET

[if user wants to see an existing blog]
SENDS to /home/<blogid> by GET

-->
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>Home - Web Log</title>
        <link rel="stylesheet" href="/static/styles.css" />
        <link rel="stylesheet" href="/static/home.css" />
    </head>
    <body>
        {% include 'header.html' %}

        <h1>Welcome to Web Log 0.1, {{ username }}</h1>
        {% if error_msg is defined %}
            <p class="error-msg">{{ error_msg }}</p>
        {% endif %}

        <div class="container">
            {% if not blogs %}
                <h3>No blogs created yet.</h3>
            {% else %}
                <table>
                    <tr><td>Blog Name</td> <td>Blog Creator</td> <td>Last Updated</td> <td>Description</td> <td>Following</td></tr>
                    {% for blog in blogs %}
                        <tr><td><a href="/home/blog/{{ blog['username'] }}">{{ blog["blogname"] }}</a></td>
                            <td>{{ blog["username"] }}</td>
                            <td>{{ blog["time"] }}</td>
                            <td>{{ blog["blogdescription"] }}</td>
                            <td>
                                {% if username != blog["username"] %}
                                    {% if blog["blogname"] not in following %}
                                    <form action="/follow/{{ blog['username'] }}" method="POST">
                                        <input type="submit" name="home" value="Follow Blog" />
                                    </form>
                                    {% else %}
                                        <form action="/unfollow/{{ blog['username'] }}" method="POST">
                                            <input type="submit" name="home" value="Unfollow Blog" />
                                        </form>
                                    {% endif %}
                                {% endif %}
                            </td>
                        </tr>
                    {% endfor %}
                </table>
            {% endif %}
        </div>
    </body>
</html>